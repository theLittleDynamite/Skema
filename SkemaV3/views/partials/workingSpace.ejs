<!-- views/partials/workingSpace1.ejs -->
<div class="workingSpace col-lg-9">
    <h1>Working Space</h1>

    <!-- Remember to implement tabs -->

    <!-- The cytoscape container -->
    <div id="cy" class="container-fluid"></div>

    <!-- Insert essential elements and properties from the database into the workspace -->
    <script>
        var cy = cytoscape({
            container: document.getElementById('cy'),
            elements: [
                <% for (var one_node of view.nodes) { %>
                        {
                            // TODO: just use style label, not data id. id cannot be changed later.
                            data: { id: '<%= one_node.node.name %>', name: '<%= one_node.node.name %>' },
                            style : { label: '<%= one_node.node.name %>' },
                            position: {
                                x: <%= one_node.x_pos %>,
                                y: <%= one_node.y_pos %>
                            }
                        },
                <% } %>
                <% for (var one_edge of view.edges) { %>
                    {
                        data: {
                            // TODO: maybe grab edge ID instead of looking for edge id in database
                            // using source and target. This is in the controller files. Might not work for new edges though
                            id: '<%= one_edge.edge._id %>',
                            source: '<%= one_edge.edge.source_node.name %>',
                            target: '<%= one_edge.edge.target_node.name %>'
                        }
                    },
                <% } %>
            ],
            style: [
                {
                    selector: 'node',
                    style: {
                        label: 'data(id)'
                    }
                }
            ],
            layout: {
                name: 'preset'
            }
        });

        var current;

        cy.on('mousedown drag', 'node', function(evt){
            current = this;
            changeText(current);
        });
    </script>
</div>
